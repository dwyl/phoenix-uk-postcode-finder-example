defmodule StoreFinder.CreateStores do
  def get_random_postcodes(n)when not is_integer(n), do: "Need to pass integer"
  def get_random_postcodes(n) when n < 1, do: "arg needs to be at least 1"
  def get_random_postcodes(n) when n >= 200, do: "arg needs to be less than 200"
  def get_random_postcodes(n), do: get_random_postcodes(n, [])

  defp get_random_postcodes(0, acc), do: acc

  defp get_random_postcodes(n, acc) do
    {:ok, res} = HTTPoison.get("https://api.postcodes.io/random/postcodes")
    {:ok, parsed_body} = Jason.decode(res.body)

    postcode =
      parsed_body["result"]["postcode"]
      |> String.replace(" ", "")
      |> String.downcase()

    lat = parsed_body["result"]["latitude"]
    long = parsed_body["result"]["longitude"]

    get_random_postcodes(n - 1, [{postcode, lat, long} | acc])
  end


  # A "here's one I made earlier" type list
  # so people do not need to call get_random_postcodes themselves
  # will also be useful for testing
  def get_store_list do
    [
      {"sk164aj", 53.475273, -2.079783},
      {"ig89fd", 51.600469, 0.020355},
      {"m253hh", 53.532044, -2.289502},
      {"sl98fe", 51.591826, -0.553728},
      {"cv326al", 52.289168, -1.558519},
      {"en93jr", 51.690581, 0.015756},
      {"pr75ld", 53.644391, -2.67151},
      {"pe39xh", 52.583033, -0.283243},
      {"b236sr", 52.522318, -1.843304},
      {"pe111bg", 52.787621, -0.153583},
      {"tq74sa", 50.323888, -3.801353},
      {"ct11yz", 51.296282, 1.103652},
      {"sy26hq", 52.689545, -2.732038},
      {"se128nr", 51.453142, 0.006762},
      {"ln59ad", 53.19476, -0.549773},
      {"hp70pn", 51.645586, -0.654868},
      {"hu52nx", 53.764633, -0.357316},
      {"dn212pb", 53.407165, -0.78154},
      {"le131ad", 52.763772, -0.879249},
      {"np108lb", 51.577959, -3.041161},
      {"hr14bu", 52.06775, -2.644082},
      {"rg208jf", 51.461366, -1.428162},
      {"bd74dp", 53.775552, -1.794195},
      {"pl112qp", 50.379287, -4.215066},
      {"ex348qb", 51.199963, -4.124893},
      {"bn25jg", 50.817167, -0.112463},
      {"rg18dn", 51.464439, -0.976861},
      {"po108ay", 50.846074, -0.924806},
      {"bb49bl", 53.694656, -2.246789},
      {"bt715pn", 54.592436, -6.699064},
      {"g431bj", 55.820387, -4.297286},
      {"po302ae", 50.696949, -1.287972},
      {"g444nr", 55.824072, -4.237103},
      {"ch497nl", 53.374641, -3.077944},
      {"po168ql", 50.855061, -1.130245},
      {"so410lp", 50.74666, -1.593416},
      {"b676lp", 52.484753, -1.985392},
      {"st31bp", 52.992435, -2.134173},
      {"nr321uj", 52.479908, 1.757555},
      {"cv64gw", 52.449854, -1.515774},
      {"g668fd", 55.964314, -4.166249},
      {"tn342ee", 50.863539, 0.583008},
      {"co76hj", 51.957933, 0.990292},
      {"al48fh", 51.806496, -0.297804},
      {"cm132hr", 51.61847, 0.339097},
      {"ta27dy", 51.02729, -3.097332},
      {"fy76qg", 53.92469, -3.020541},
      {"tn103es", 51.211847, 0.278637},
      {"sa611bw", 51.798922, -4.979514},
      {"ng250lx", 53.076382, -0.964699},
      {"l744ad", 53.392999, -2.988285},
      {"cm12tt", 51.731325, 0.447123},
      {"s63ea", 53.389375, -1.484961},
      {"tw165ph", 51.408543, -0.399054},
      {"yo111ld", 54.281531, -0.402733},
      {"wf26ah", 53.66409, -1.48513},
      {"bt538dd", 55.114664, -6.441807},
      {"ox28et", 51.794058, -1.272268},
      {"cb42tw", 52.231652, 0.128513},
      {"ex394qt", 50.973035, -4.167325},
      {"ml85na", 55.722309, -3.835955},
      {"la88pa", 54.272795, -2.790765},
      {"tn158hf", 51.290559, 0.309712},
      {"nn84tw", 52.314373, -0.688849},
      {"kw106tt", 57.970643, -3.982215},
      {"s418we", 53.252108, -1.462659},
      {"cw72by", 53.196892, -2.534115},
      {"ls85du", 53.808447, -1.526678},
      {"s61sr", 53.416973, -1.520136},
      {"dn110ug", 53.477341, -1.055544},
      {"dn58qu", 53.537105, -1.176872},
      {"me81eh", 51.36618, 0.575541},
      {"ab116qf", 57.145726, -2.09641},
      {"hu181jd", 53.91864, -0.165331},
      {"rg278aw", 51.307871, -0.874828},
      {"ec4r2sh", 51.511441, -0.091256},
      {"rg14qt", 51.452379, -0.964379},
      {"nr134tq", 52.623783, 1.494778},
      {"sw101aw", 51.484744, -0.183629},
      {"tw45ef", 51.460984, -0.38186},
      {"cf399ne", 51.60937, -3.398136},
      {"hu74sr", 53.78668, -0.304783},
      {"sw178jh", 51.433327, -0.15327},
      {"hp65px", 51.680461, -0.619699},
      {"sw177dd", 51.437989, -0.164981},
      {"le183sw", 52.575744, -1.097083},
      {"ip186rt", 52.338982, 1.664624},
      {"pa160dl", 55.915985, -4.849244},
      {"ll170ej", 53.252135, -3.435899},
      {"ct149ef", 51.20842, 1.384451},
      {"ox183ja", 51.760362, -1.593699},
      {"cv359tb", 52.190377, -1.600033},
      {"so199jb", 50.888446, -1.362184},
      {"nr217hn", 52.77798, 0.784236},
      {"bt701jl", 54.502707, -6.784704},
      {"nn188qs", 52.464661, -0.702626},
      {"pl40nl", 50.369798, -4.127391},
      {"ls297qh", 53.902241, -1.74321},
      {"ts58eq", 54.530129, -1.245368},
      {"n146lg", 51.623742, -0.122664},
      {"pl268pf", 50.396403, -4.793402},
      {"w139ed", 51.506596, -0.323802},
      {"sw101bz", 51.484744, -0.183629},
      {"dd53pp", 56.526577, -2.881395},
      {"kt58tt", 51.389351, -0.294947},
      {"bs79pz", 51.486207, -2.577093},
      {"e111sl", 51.568696, 0.006854},
      {"rh116al", 51.101289, -0.228536},
      {"ne650tj", 55.341394, -1.612685},
      {"ts134jp", 54.552442, -0.880689},
      {"hg31eh", 53.96706, -1.479012},
      {"sp34ul", 51.151793, -1.858819},
      {"hx35re", 53.739254, -1.881376},
      {"tq139qa", 50.61471, -3.653137},
      {"ha87pg", 51.614369, -0.280967},
      {"sy120dn", 52.90508, -2.899723},
      {"lu55pn", 51.911431, -0.510002},
      {"ss129nr", 51.602009, 0.535838},
      {"bb185ax", 53.912851, -2.185613},
      {"pl210pu", 50.348944, -3.88665},
      {"eh166eu", 55.90689, -3.157962},
      {"bb186xz", 53.910774, -2.14703},
      {"b450hj", 52.401378, -2.024016},
      {"al11jn", 51.744938, -0.324802},
      {"ab129uf", 57.148707, -2.097806},
      {"bs151qd", 51.471886, -2.513073},
      {"ne650jb", 55.314724, -1.5791},
      {"e125hx", 51.554031, 0.051446},
      {"gl12jb", 51.865994, -2.24867},
      {"np70du", 51.826061, -3.092726},
      {"hd88ed", 53.586849, -1.70402},
      {"sw114nj", 51.476232, -0.160826},
      {"eh309bg", 55.981436, -3.398032},
      {"wa50ht", 53.411427, -2.605898},
      {"ne64bd", 54.978149, -1.558395},
      {"sy70ef", 52.313168, -2.905345},
      {"sp78du", 51.013975, -2.189},
      {"pl350hb", 50.690113, -4.692332},
      {"ox294tl", 51.776759, -1.378906},
      {"ng208dj", 53.202468, -1.221127},
      {"fk29xz", 55.987858, -3.731992},
      {"rg46xd", 51.469983, -0.906694},
      {"rg89pp", 51.522689, -1.150482},
      {"wr11re", 52.204902, -2.221348},
      {"dd39bz", 56.489306, -2.995997},
      {"cr77ne", 51.401423, -0.115004},
      {"ip326ar", 52.252414, 0.713239},
      {"l373ha", 53.55774, -3.065505},
      {"sw178lg", 51.426657, -0.158573},
      {"dy20ef", 52.477553, -2.092153},
      {"nr339ht", 52.462463, 1.715555},
      {"bb112ja", 53.783384, -2.238963},
      {"ex313jr", 51.021469, -4.079607},
      {"bt943ag", 54.392334, -7.508087},
      {"sn34hz", 51.573427, -1.736371},
      {"ne159aa", 54.995534, -1.754743},
      {"ca12wg", 54.891095, -2.909804},
      {"ln117jq", 53.453981, 0.080451},
      {"po40sp", 50.778953, -1.076141},
      {"e152rb", 51.532291, -0.008806},
      {"wf160jr", 53.706598, -1.672489},
      {"eh104sz", 55.927942, -3.208558},
      {"gu273jd", 51.046267, -0.710403},
      {"bh213hb", 50.783596, -2.024062},
      {"ig89ql", 51.608972, 0.019534},
      {"s122jx", 53.345239, -1.427317},
      {"bn99rl", 50.792406, 0.049432},
      {"pl34hp", 50.3819, -4.154518},
      {"pl219jx", 50.359453, -3.941438},
      {"gl68bp", 51.727424, -2.148312},
      {"sa389aq", 52.038825, -4.466857},
      {"hx61bx", 53.705763, -1.925538},
      {"m288by", 53.51305, -2.362208},
      {"ex226lp", 50.808246, -4.385097},
      {"nn69jz", 52.347298, -0.872178},
      {"ph118bl", 56.621432, -3.235278},
      {"bb74dp", 53.904692, -2.306884},
      {"ng95bn", 52.91699, -1.230094},
      {"dd15pz", 56.462, -2.992929},
      {"ka204lb", 55.656437, -4.745476},
      {"ws124be", 52.714865, -2.007507},
      {"pe111ph", 52.793577, -0.159634},
      {"dl79ey", 54.284446, -1.437977},
      {"np133lg", 51.770655, -3.154807},
      {"ba100ef", 51.110638, -2.454249},
      {"me174ef", 51.230482, 0.505126},
      {"eh548dt", 55.899656, -3.558709},
      {"ne646bj", 55.190769, -1.511266},
      {"so167gd", 50.952171, -1.405602},
      {"fk65ns", 56.008291, -3.911527},
      {"ng242qa", 53.08076, -0.757961},
      {"co94nr", 52.021181, 0.505727},
      {"sk137pw", 53.428304, -1.942366},
      {"bd50ba", 53.789366, -1.758364},
      {"np263hp", 51.582736, -2.833669},
      {"bt490lr", 55.178607, -6.95165},
      {"sn160qh", 51.587217, -2.113762}
    ]
  end
end
